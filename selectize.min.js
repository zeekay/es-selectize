/*! selectize.js | https://github.com/brianreavis/selectize.js | Apache License (v2) */
var Selectize=function(){"use strict";var e={a:"[a\u1e00\u1e01\u0102\u0103\xc2\xe2\u01cd\u01ce\u023a\u2c65\u0226\u0227\u1ea0\u1ea1\xc4\xe4\xc0\xe0\xc1\xe1\u0100\u0101\xc3\xe3\xc5\xe5\u0105\u0104\xc3\u0105\u0104]",b:"[b\u2422\u03b2\u0392B\u0e3f\ud800\udf01\u16d2]",c:"[c\u0106\u0107\u0108\u0109\u010c\u010d\u010a\u010bC\u0304c\u0304\xc7\xe7\u1e08\u1e09\u023b\u023c\u0187\u0188\u0255\u1d04\uff23\uff43]",d:"[d\u010e\u010f\u1e0a\u1e0b\u1e10\u1e11\u1e0c\u1e0d\u1e12\u1e13\u1e0e\u1e0f\u0110\u0111D\u0326d\u0326\u0189\u0256\u018a\u0257\u018b\u018c\u1d6d\u1d81\u1d91\u0221\u1d05\uff24\uff44\xf0]",e:"[e\xc9\xe9\xc8\xe8\xca\xea\u1e18\u1e19\u011a\u011b\u0114\u0115\u1ebc\u1ebd\u1e1a\u1e1b\u1eba\u1ebb\u0116\u0117\xcb\xeb\u0112\u0113\u0228\u0229\u0118\u0119\u1d92\u0246\u0247\u0204\u0205\u1ebe\u1ebf\u1ec0\u1ec1\u1ec4\u1ec5\u1ec2\u1ec3\u1e1c\u1e1d\u1e16\u1e17\u1e14\u1e15\u0206\u0207\u1eb8\u1eb9\u1ec6\u1ec7\u2c78\u1d07\uff25\uff45\u0258\u01dd\u018f\u0190\u03b5]",f:"[f\u0191\u0192\u1e1e\u1e1f]",g:"[g\u0262\u20b2\u01e4\u01e5\u011c\u011d\u011e\u011f\u0122\u0123\u0193\u0260\u0120\u0121]",h:"[h\u0124\u0125\u0126\u0127\u1e28\u1e29\u1e96\u1e96\u1e24\u1e25\u1e22\u1e23\u0266\u02b0\u01f6\u0195]",i:"[i\xcd\xed\xcc\xec\u012c\u012d\xce\xee\u01cf\u01d0\xcf\xef\u1e2e\u1e2f\u0128\u0129\u012e\u012f\u012a\u012b\u1ec8\u1ec9\u0208\u0209\u020a\u020b\u1eca\u1ecb\u1e2c\u1e2d\u0197\u0268\u0268\u0306\u1d7b\u1d96\u0130iI\u0131\u026a\uff29\uff49]",j:"[j\u0237\u0134\u0135\u0248\u0249\u029d\u025f\u02b2]",k:"[k\u0198\u0199\ua740\ua741\u1e30\u1e31\u01e8\u01e9\u1e32\u1e33\u1e34\u1e35\u03ba\u03f0\u20ad]",l:"[l\u0141\u0142\u013d\u013e\u013b\u013c\u0139\u013a\u1e36\u1e37\u1e38\u1e39\u1e3c\u1e3d\u1e3a\u1e3b\u013f\u0140\u023d\u019a\u2c60\u2c61\u2c62\u026b\u026c\u1d85\u026d\u0234\u029f\uff2c\uff4c]",n:"[n\u0143\u0144\u01f8\u01f9\u0147\u0148\xd1\xf1\u1e44\u1e45\u0145\u0146\u1e46\u1e47\u1e4a\u1e4b\u1e48\u1e49N\u0308n\u0308\u019d\u0272\u0220\u019e\u1d70\u1d87\u0273\u0235\u0274\uff2e\uff4e\u014a\u014b]",o:"[o\xd8\xf8\xd6\xf6\xd3\xf3\xd2\xf2\xd4\xf4\u01d1\u01d2\u0150\u0151\u014e\u014f\u022e\u022f\u1ecc\u1ecd\u019f\u0275\u01a0\u01a1\u1ece\u1ecf\u014c\u014d\xd5\xf5\u01ea\u01eb\u020c\u020d\u0555\u0585]",p:"[p\u1e54\u1e55\u1e56\u1e57\u2c63\u1d7d\u01a4\u01a5\u1d71]",q:"[q\ua756\ua757\u02a0\u024a\u024b\ua758\ua759q\u0303]",r:"[r\u0154\u0155\u024c\u024d\u0158\u0159\u0156\u0157\u1e58\u1e59\u0210\u0211\u0212\u0213\u1e5a\u1e5b\u2c64\u027d]",s:"[s\u015a\u015b\u1e60\u1e61\u1e62\u1e63\ua7a8\ua7a9\u015c\u015d\u0160\u0161\u015e\u015f\u0218\u0219S\u0308s\u0308]",t:"[t\u0164\u0165\u1e6a\u1e6b\u0162\u0163\u1e6c\u1e6d\u01ae\u0288\u021a\u021b\u1e70\u1e71\u1e6e\u1e6f\u01ac\u01ad]",u:"[u\u016c\u016d\u0244\u0289\u1ee4\u1ee5\xdc\xfc\xda\xfa\xd9\xf9\xdb\xfb\u01d3\u01d4\u0170\u0171\u016c\u016d\u01af\u01b0\u1ee6\u1ee7\u016a\u016b\u0168\u0169\u0172\u0173\u0214\u0215\u222a]",v:"[v\u1e7c\u1e7d\u1e7e\u1e7f\u01b2\u028b\ua75e\ua75f\u2c71\u028b]",w:"[w\u1e82\u1e83\u1e80\u1e81\u0174\u0175\u1e84\u1e85\u1e86\u1e87\u1e88\u1e89]",x:"[x\u1e8c\u1e8d\u1e8a\u1e8b\u03c7]",y:"[y\xdd\xfd\u1ef2\u1ef3\u0176\u0177\u0178\xff\u1ef8\u1ef9\u1e8e\u1e8f\u1ef4\u1ef5\u024e\u024f\u01b3\u01b4]",z:"[z\u0179\u017a\u1e90\u1e91\u017d\u017e\u017b\u017c\u1e92\u1e93\u1e94\u1e95\u01b5\u01b6]"};var t=function(){var t,n,i,r;var o="";var s={};for(i in e){if(e.hasOwnProperty(i)){r=e[i].substring(2,e[i].length-1);o+=r;for(t=0,n=r.length;t<n;t++){s[r.charAt(t)]=i}}}var a=new RegExp("["+o+"]","g");return function(e){return e.replace(a,function(e){return s[e]}).toLowerCase()}}();function n(e,n){if(typeof e==="number"&&typeof n==="number"){return e>n?1:e<n?-1:0}e=t(String(e||""));n=t(String(n||""));if(e>n)return 1;if(n>e)return-1;return 0}function i(e,t){var n,i,r,o;for(n=1,i=arguments.length;n<i;n++){o=arguments[n];if(!o)continue;for(r in o){if(o.hasOwnProperty(r)){e[r]=o[r]}}}return e}function r(e,t,n){if(!e||!t)return;if(!n)return e[t];var i=t.split(".");while(i.length&&(e=e[i.shift()]));return e}function o(e){return(e+"").replace(/^\s+|\s+$|/g,"")}function s(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}const a=Array.isArray||typeof $!=="undefined"&&$.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function l(e,t){this.items=e;this.settings=t||{diacritics:true}}l.prototype.tokenize=function(t){t=o(String(t||"").toLowerCase());if(!t||!t.length)return[];var n,i,r,a;var l=[];var u=t.split(/ +/);for(n=0,i=u.length;n<i;n++){r=s(u[n]);if(this.settings.diacritics){for(a in e){if(e.hasOwnProperty(a)){r=r.replace(new RegExp(a,"g"),e[a])}}}l.push({string:u[n],regex:new RegExp(r,"i")})}return l};l.prototype.iterator=function(e,t){var n;if(a(e)){n=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++){e(this[t],t,this)}}}else{n=function(e){for(var t in this){if(this.hasOwnProperty(t)){e(this[t],t,this)}}}}n.apply(e,[t])};l.prototype.getScoreFunction=function(e,t){var n,i,o,s,a;n=this;e=n.prepareSearch(e,t);o=e.tokens;i=e.options.fields;s=o.length;a=e.options.nesting;function l(e,t){var n,i;if(!e)return 0;e=String(e||"");i=e.search(t.regex);if(i===-1)return 0;n=t.string.length/e.length;if(i===0)n+=.5;return n}var u=function(){var e=i.length;if(!e){return function(){return 0}}if(e===1){return function(e,t){return l(r(t,i[0],a),e)}}return function(t,n){for(var o=0,s=0;o<e;o++){s+=l(r(n,i[o],a),t)}return s/e}}();if(!s){return function(){return 0}}if(s===1){return function(e){return u(o[0],e)}}if(e.options.conjunction==="and"){return function(e){var t;for(var n=0,i=0;n<s;n++){t=u(o[n],e);if(t<=0)return 0;i+=t}return i/s}}else{return function(e){for(var t=0,n=0;t<s;t++){n+=u(o[t],e)}return n/s}}};l.prototype.getSortFunction=function(e,t){var i,o,s,a,l,u,p,c,f,d;s=this;e=s.prepareSearch(e,t);f=!e.query&&t.sortEmpty||t.sort;function h(e,n){if(e==="$score")return n.score;return r(s.items[n.id],e,t.nesting)}l=[];if(f){for(i=0,o=f.length;i<o;i++){if(e.query||f[i].field!=="$score"){l.push(f[i])}}}if(e.query){d=true;for(i=0,o=l.length;i<o;i++){if(l[i].field==="$score"){d=false;break}}if(d){l.unshift({field:"$score",direction:"desc"})}}else{for(i=0,o=l.length;i<o;i++){if(l[i].field==="$score"){l.splice(i,1);break}}}c=[];for(i=0,o=l.length;i<o;i++){c.push(l[i].direction==="desc"?-1:1)}u=l.length;if(!u){return null}else if(u===1){a=l[0].field;p=c[0];return function(e,t){return p*n(h(a,e),h(a,t))}}else{return function(e,t){var i,r,o;for(i=0;i<u;i++){o=l[i].field;r=c[i]*n(h(o,e),h(o,t));if(r)return r}return 0}}};l.prototype.prepareSearch=function(e,t){if(typeof e==="object")return e;t=i({},t);var n=t.fields;var r=t.sort;var o=t.sortEmpty;if(n&&!a(n))t.fields=[n];if(r&&!a(r))t.sort=[r];if(o&&!a(o))t.sortEmpty=[o];return{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}};l.prototype.search=function(e,t){var n=this,i,r;var o;var s;r=this.prepareSearch(e,t);t=r.options;e=r.query;s=t.score||n.getScoreFunction(r);if(e.length){n.iterator(n.items,function(e,n){i=s(e);if(t.filter===false||i>0){r.items.push({score:i,id:n})}})}else{n.iterator(n.items,function(e,t){r.items.push({score:1,id:t})})}o=n.getSortFunction(r,t);if(o)r.items.sort(o);r.total=r.items.length;if(typeof t.limit==="number"){r.items=r.items.slice(0,t.limit)}return r};var u;var p;var c;var f;var d;var h;var g;f=Object.prototype;d=f.hasOwnProperty;g=f.toString;h=void 0;if(typeof Symbol==="function"){h=Symbol.prototype.valueOf}u=function(e){return e!==e};var v=function(e,t){var n,i;if(e===t){return true}i=g.call(e);if(i!==g.call(t)){return false}if(i==="[object Object]"){for(n in e){if(!v(e[n],t[n])||!(n in t)){return false}}for(n in t){if(!v(e[n],t[n])||!(n in e)){return false}}return true}if(i==="[object Array]"){n=e.length;if(n!==t.length){return false}while(n--){if(!v(e[n],t[n])){return false}}return true}if(i==="[object Function]"){return e.prototype===t.prototype}if(i==="[object Date]"){return e.getTime()===t.getTime()}return false};var m=function(e){return!!e&&!O(e)&&d.call(e,"length")&&isFinite(e.length)&&b(e.length)&&e.length>=0};var y=p=function(e){var t,n;n=g.call(e)==="[object Arguments]";t=!w(e)&&m(e)&&I(e)&&c(e.callee);return n||t};var w=Array.isArray||function(e){return g.call(e)==="[object Array]"};var O=function(e){return g.call(e)==="[object Boolean]"};var C=c=function(e){var t,n;t=typeof window!=="undefined"&&e===window.alert;if(t){return true}n=g.call(e);return n==="[object Function]"||n==="[object GeneratorFunction]"||n==="[object AsyncFunction]"};var b=function(e){return g.call(e)==="[object Number]"};var I=function(e){return g.call(e)==="[object Object]"};const S={};S.mixin=function(e){e.plugins={};e.prototype.initializePlugins=function(e){var t,n,i;var r=this;var o=[];r.plugins={names:[],settings:{},requested:{},loaded:{}};if(w(e)){for(t=0,n=e.length;t<n;t++){if(typeof e[t]==="string"){o.push(e[t])}else{r.plugins.settings[e[t].name]=e[t].options;o.push(e[t].name)}}}else if(e){for(i in e){if(e.hasOwnProperty(i)){r.plugins.settings[i]=e[i];o.push(i)}}}while(o.length){r.require(o.shift())}};e.prototype.loadPlugin=function(t){var n=this;var i=n.plugins;var r=e.plugins[t];if(!e.plugins.hasOwnProperty(t)){throw new Error('Unable to find "'+t+'" plugin')}i.requested[t]=true;i.loaded[t]=r.fn.apply(n,[n.plugins.settings[t]||{}]);i.names.push(t)};e.prototype.require=function(e){var t=this;var n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e]){throw new Error('Plugin has circular dependency ("'+e+'")')}t.loadPlugin(e)}return n.loaded[e]};e.define=function(t,n){e.plugins[t]={name:t,fn:n}}};function x(){}x.prototype={on:function(e,t){this._events=this._events||{};this._events[e]=this._events[e]||[];this._events[e].push(t)},off:function(e,t){var n=arguments.length;if(n===0)return delete this._events;if(n===1)return delete this._events[e];this._events=this._events||{};if(e in this._events===false)return;this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){this._events=this._events||{};if(e in this._events===false)return;for(var t=0;t<this._events[e].length;t++){this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}}};x.mixin=function(e){var t=["on","off","trigger"];for(var n=0;n<t.length;n++){e.prototype[t[n]]=x.prototype[t[n]]}};function F(e,t){if(typeof t==="string"&&!t.length)return;var n=typeof t==="string"?new RegExp(t,"i"):t;var i=function(e){var t=0;if(e.nodeType===3){var r=e.data.search(n);if(r>=0&&e.data.length>0){var o=document.createElement("span");o.className="highlight";var s=e.splitText(r);var a=s.cloneNode(true);o.appendChild(a);s.parentNode.replaceChild(o,s);t=1}}else if(e.nodeType===1&&e.childNodes&&!/(script|style)/i.test(e.tagName)){for(var l=0;l<e.childNodes.length;++l){l+=i(e.childNodes[l])}}return t};return e.each(function(){i(this)})}$.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){var e=this.parentNode;e.replaceChild(this.firstChild,this);e.normalize()}).end()};var A={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:true,diacritics:true,create:false,createOnBlur:false,createFilter:null,highlight:true,openOnFocus:true,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:false,selectOnTab:false,preload:false,allowEmptyOption:false,closeAfterSelect:false,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:false,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:true,render:{}};var D=/Mac/.test(navigator.userAgent);var P=65;var k=13;var T=27;var j=37;var z=38;var E=80;var N=39;var V=40;var H=78;var L=8;var R=46;var q=16;var K=D?91:17;var _=D?18:17;var B=9;var G=1;var Q=2;var M=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity;function W(e){return typeof e!=="undefined"}function U(e){if(typeof e==="undefined"||e===null)return null;if(typeof e==="boolean")return e?"1":"0";return e+""}function J(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function X(e){var t=false;return function(){if(t)return;t=true;e.apply(this,arguments)}}function Y(e,t){var n;return function(){var i=this;var r=arguments;window.clearTimeout(n);n=window.setTimeout(function(){e.apply(i,r)},t)}}function Z(e,t,n){var i;var r=e.trigger;var o={};e.trigger=function(){var n=arguments[0];if(t.indexOf(n)!==-1){o[n]=arguments}else{return r.apply(e,arguments)}};n.apply(e,[]);e.trigger=r;for(i in o){if(o.hasOwnProperty(i)){r.apply(e,o[i])}}}function ee(e,t,n,i){e.on(t,n,function(t){var n=t.target;while(n&&n.parentNode!==e[0]){n=n.parentNode}t.currentTarget=n;return i.apply(this,[t])})}function te(e){var t={};if("selectionStart"in e){t.start=e.selectionStart;t.length=e.selectionEnd-t.start}else if(document.selection){e.focus();var n=document.selection.createRange();var i=document.selection.createRange().text.length;n.moveStart("character",-e.value.length);t.start=n.text.length-i;t.length=i}return t}function ne(e,t,n){var i,r,o={};if(n){for(i=0,r=n.length;i<r;i++){o[n[i]]=e.css(n[i])}}else{o=e.css()}t.css(o)}function ie(e,t){if(!e){return 0}var n=$("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(e).appendTo("body");ne(t,n,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var i=n.width();n.remove();return i}function re(e){var t=null;var n=function(n,i){var r,o,s,a,l;var u,p,c;n=n||window.event||{};i=i||{};if(n.metaKey||n.altKey)return;if(!i.force&&e.data("grow")===false)return;r=e.val();if(n.type&&n.type.toLowerCase()==="keydown"){o=n.keyCode;s=o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===32;if(o===R||o===L){c=te(e[0]);if(c.length){r=r.substring(0,c.start)+r.substring(c.start+c.length)}else if(o===L&&c.start){r=r.substring(0,c.start-1)+r.substring(c.start+1)}else if(o===R&&typeof c.start!=="undefined"){r=r.substring(0,c.start)+r.substring(c.start+1)}}else if(s){u=n.shiftKey;p=String.fromCharCode(n.keyCode);if(u)p=p.toUpperCase();else p=p.toLowerCase();r+=p}}a=e.attr("placeholder");if(!r&&a){r=a}l=ie(r,e)+4;if(l!==t){t=l;e.width(l);e.triggerHandler("resize")}};e.on("keydown keyup update blur",n);n()}function oe(e){var t=document.createElement("div");t.appendChild(e.cloneNode(true));return t.innerHTML}function se(e,t){var n,i,r,o,s=this;o=e[0];o.selectize=s;var a=window.getComputedStyle&&window.getComputedStyle(o,null);r=a?a.getPropertyValue("direction"):o.currentStyle&&o.currentStyle.direction;r=r||e.parents("[dir]:first").attr("dir")||"";$.extend(s,{order:0,settings:t,$input:e,tabIndex:e.attr("tabindex")||"",tagType:o.tagName.toLowerCase()==="select"?G:Q,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++se.count,highlightedValue:null,isOpen:false,isDisabled:false,isRequired:e.is("[required]"),isInvalid:false,isLocked:false,isFocused:false,isInputHidden:false,isSetup:false,isShiftDown:false,isCmdDown:false,isCtrlDown:false,ignoreFocus:false,ignoreBlur:false,ignoreHover:false,hasOptions:false,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:t.loadThrottle===null?s.onSearchChange:Y(s.onSearchChange,t.loadThrottle)});s.sifter=new l(this.options,{diacritics:t.diacritics});if(s.settings.options){for(n=0,i=s.settings.options.length;n<i;n++){s.registerOption(s.settings.options[n])}delete s.settings.options}if(s.settings.optgroups){for(n=0,i=s.settings.optgroups.length;n<i;n++){s.registerOptionGroup(s.settings.optgroups[n])}delete s.settings.optgroups}s.settings.mode=s.settings.mode||(s.settings.maxItems===1?"single":"multi");if(typeof s.settings.hideSelected!=="boolean"){s.settings.hideSelected=s.settings.mode==="multi"}s.initializePlugins(s.settings.plugins);s.setupCallbacks();s.setupTemplates();s.setup()}se.defaults=A;se.count=0;x.mixin(se);S.mixin(se);$.extend(se.prototype,{setup:function(){var e=this;var t=e.settings;var n=e.eventNS;var i=$(window);var r=$(document);var o=e.$input;var s;var a;var l;var u;var p;var c;var f;var d;var h;var g;f=e.settings.mode;d=o.attr("class")||"";s=$("<div>").addClass(t.wrapperClass).addClass(d).addClass(f);a=$("<div>").addClass(t.inputClass).addClass("items").appendTo(s);l=$('<input type="text" autocomplete="off" />').appendTo(a).attr("tabindex",o.is(":disabled")?"-1":e.tabIndex);c=$(t.dropdownParent||s);u=$("<div>").addClass(t.dropdownClass).addClass(f).hide().appendTo(c);p=$("<div>").addClass(t.dropdownContentClass).appendTo(u);if(g=o.attr("id")){l.attr("id",g+"-selectized");$('label[for="'+g+'"]').attr("for",g+"-selectized")}if(e.settings.copyClassesToDropdown){u.addClass(d)}s.css({width:o[0].style.width});if(e.plugins.names.length){h="plugin-"+e.plugins.names.join(" plugin-");s.addClass(h);u.addClass(h)}if((t.maxItems===null||t.maxItems>1)&&e.tagType===G){o.attr("multiple","multiple")}if(e.settings.placeholder){l.attr("placeholder",t.placeholder)}if(!e.settings.splitOn&&e.settings.delimiter){var v=e.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");e.settings.splitOn=new RegExp("\\s*"+v+"+\\s*")}if(o.attr("autocorrect")){l.attr("autocorrect",o.attr("autocorrect"))}if(o.attr("autocapitalize")){l.attr("autocapitalize",o.attr("autocapitalize"))}e.$wrapper=s;e.$control=a;e.$controlInput=l;e.$dropdown=u;e.$dropdownContent=p;u.on("mouseenter","[data-selectable]",function(){return e.onOptionHover.apply(e,arguments)});u.on("mousedown click","[data-selectable]",function(){return e.onOptionSelect.apply(e,arguments)});ee(a,"mousedown","*:not(input)",function(){return e.onItemSelect.apply(e,arguments)});re(l);a.on({mousedown:function(){return e.onMouseDown.apply(e,arguments)},click:function(){return e.onClick.apply(e,arguments)}});l.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return e.onKeyDown.apply(e,arguments)},keyup:function(){return e.onKeyUp.apply(e,arguments)},keypress:function(){return e.onKeyPress.apply(e,arguments)},resize:function(){e.positionDropdown.apply(e,[])},blur:function(){return e.onBlur.apply(e,arguments)},focus:function(){e.ignoreBlur=false;return e.onFocus.apply(e,arguments)},paste:function(){return e.onPaste.apply(e,arguments)}});r.on("keydown"+n,function(t){e.isCmdDown=t[D?"metaKey":"ctrlKey"];e.isCtrlDown=t[D?"altKey":"ctrlKey"];e.isShiftDown=t.shiftKey});r.on("keyup"+n,function(t){if(t.keyCode===_)e.isCtrlDown=false;if(t.keyCode===q)e.isShiftDown=false;if(t.keyCode===K)e.isCmdDown=false});r.on("mousedown"+n,function(t){if(e.isFocused){if(t.target===e.$dropdown[0]||t.target.parentNode===e.$dropdown[0]){return false}if(!e.$control.has(t.target).length&&t.target!==e.$control[0]){e.blur(t.target)}}});i.on(["scroll"+n,"resize"+n].join(" "),function(){if(e.isOpen){e.positionDropdown.apply(e,arguments)}});i.on("mousemove"+n,function(){e.ignoreHover=false});this.revertSettings={$children:o.children().detach(),tabindex:o.attr("tabindex")};o.attr("tabindex",-1).hide().after(e.$wrapper);if($.isArray(t.items)){e.setValue(t.items);delete t.items}if(M){o.on("invalid"+n,function(t){t.preventDefault();e.isInvalid=true;e.refreshState()})}e.updateOriginalInput();e.refreshItems();e.refreshState();e.updatePlaceholder();e.isSetup=true;if(o.is(":disabled")){e.disable()}e.on("change",this.onChange);o.data("selectize",e);o.addClass("selectized");e.trigger("initialize");if(t.preload===true){e.onSearchChange("")}},setupTemplates:function(){var e=this;var t=e.settings.labelField;var n=e.settings.optgroupLabelField;var i={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroupHeader:function(e,t){return'<div class="optgroup-header">'+t(e[n])+"</div>"},option:function(e,n){return'<div class="option">'+n(e[t])+"</div>"},item:function(e,n){return'<div class="item">'+n(e[t])+"</div>"},optionCreate:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};e.settings.render=$.extend({},i,e.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",itemAdd:"onItemAdd",itemRemove:"onItemRemove",clear:"onClear",optionAdd:"onOptionAdd",optionRemove:"onOptionRemove",optionClear:"onOptionClear",optgroupAdd:"onOptionGroupAdd",optgroupRemove:"onOptionGroupRemove",optgroupClear:"onOptionGroupClear",dropdownOpen:"onDropdownOpen",dropdownClose:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n){if(n.hasOwnProperty(e)){t=this.settings[n[e]];if(t)this.on(e,t)}}},onClick:function(e){var t=this;if(!t.isFocused){t.focus();e.preventDefault()}},onMouseDown:function(e){var t=this;var n=e.isDefaultPrevented();if(t.isFocused){if(e.target!==t.$controlInput[0]){if(t.settings.mode==="single"){if(t.isOpen)t.close();else t.open()}else if(!n){t.setActiveItem(null)}return false}}else{if(!n){window.setTimeout(function(){t.focus()},0)}}},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var t=this;if(t.isFull()||t.isInputHidden||t.isLocked){e.preventDefault();return}if(t.settings.splitOn){setTimeout(function(){var e=t.$controlInput.val();if(!e.match(t.settings.splitOn)){return}var n=$.trim(e).split(t.settings.splitOn);for(var i=0,r=n.length;i<r;i++){t.createItem(n[i])}},0)}},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);if(this.settings.create&&this.settings.mode==="multi"&&t===this.settings.delimiter){this.createItem();e.preventDefault();return false}},onKeyDown:function(e){var t=this;if(t.isLocked){if(e.keyCode!==B){e.preventDefault()}return}switch(e.keyCode){case P:if(t.isCmdDown){t.selectAll();return}break;case T:if(t.isOpen){e.preventDefault();e.stopPropagation();t.close()}return;case H:if(!e.ctrlKey||e.altKey)break;case V:if(!t.isOpen&&t.hasOptions){t.open()}else if(t.$activeOption){t.ignoreHover=true;var n=t.getAdjacentOption(t.$activeOption,1);if(n.length)t.setActiveOption(n,true,true)}e.preventDefault();return;case E:if(!e.ctrlKey||e.altKey)break;case z:if(t.$activeOption){t.ignoreHover=true;var i=t.getAdjacentOption(t.$activeOption,-1);if(i.length)t.setActiveOption(i,true,true)}e.preventDefault();return;case k:if(t.isOpen&&t.$activeOption){t.onOptionSelect({currentTarget:t.$activeOption});e.preventDefault()}return;case j:t.advanceSelection(-1,e);return;case N:t.advanceSelection(1,e);return;case B:if(t.settings.selectOnTab&&t.isOpen&&t.$activeOption){t.onOptionSelect({currentTarget:t.$activeOption});if(!t.isFull()){e.preventDefault()}}if(t.settings.create&&t.createItem()){e.preventDefault()}return;case L:case R:t.deleteSelection(e);return}if((t.isFull()||t.isInputHidden)&&!(D?e.metaKey:e.ctrlKey)){e.preventDefault();return}},onKeyUp:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();var n=t.$controlInput.val()||"";if(t.lastValue!==n){t.lastValue=n;t.onSearchChange(n);t.refreshOptions();t.trigger("type",n)}},onSearchChange:function(e){var t=this;var n=t.settings.load;if(!n)return;if(t.loadedSearches.hasOwnProperty(e))return;t.loadedSearches[e]=true;t.load(function(i){n.apply(t,[e,i])})},onFocus:function(e){var t=this;var n=t.isFocused;if(t.isDisabled){t.blur();if(e)e.preventDefault();return false}if(t.ignoreFocus)return;t.isFocused=true;if(t.settings.preload==="focus")t.onSearchChange("");if(!n)t.trigger("focus");if(!t.$activeItems.length){t.showInput();t.setActiveItem(null);t.refreshOptions(!!t.settings.openOnFocus)}t.refreshState()},onBlur:function(e,t){var n=this;if(!n.isFocused)return;n.isFocused=false;if(n.ignoreFocus){return}else if(!n.ignoreBlur&&document.activeElement===n.$dropdownContent[0]){n.ignoreBlur=true;n.onFocus(e);return}var i=function(){n.close();n.setTextboxValue("");n.setActiveItem(null);n.setActiveOption(null);n.setCaret(n.items.length);n.refreshState();if(t&&t.focus)t.focus();n.ignoreFocus=false;n.trigger("blur")};n.ignoreFocus=true;if(n.settings.create&&n.settings.createOnBlur){n.createItem(null,false,i)}else{i()}},onOptionHover:function(e){if(this.ignoreHover)return;this.setActiveOption(e.currentTarget,false)},onOptionSelect:function(e){var t,n,i=this;if(e.preventDefault){e.preventDefault();e.stopPropagation()}n=$(e.currentTarget);if(n.hasClass("create")){i.createItem(null,function(){if(i.settings.closeAfterSelect){i.close()}})}else{t=n.attr("data-value");if(typeof t!=="undefined"){i.lastQuery=null;i.setTextboxValue("");i.addItem(t);if(i.settings.closeAfterSelect){i.close()}else if(!i.settings.hideSelected&&e.type&&/mouse/.test(e.type)){i.setActiveOption(i.getOption(t))}}}},onItemSelect:function(e){var t=this;if(t.isLocked)return;if(t.settings.mode==="multi"){e.preventDefault();t.setActiveItem(e.currentTarget,e)}},load:function(e){var t=this;var n=t.$wrapper.addClass(t.settings.loadingClass);t.loading++;e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0);if(e&&e.length){t.addOption(e);t.refreshOptions(t.isFocused&&!t.isInputHidden)}if(!t.loading){n.removeClass(t.settings.loadingClass)}t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$controlInput;var n=t.val()!==e;if(n){t.val(e).triggerHandler("update");this.lastValue=e}},getValue:function(){if(this.tagType===G&&this.$input.attr("multiple")){return this.items}else{return this.items.join(this.settings.delimiter)}},setValue:function(e,t){var n=t?[]:["change"];Z(this,n,function(){this.clear(t);this.addItems(e,t)})},setActiveItem:function(e,t){var n=this;var i;var r,o,s,a,l,u;var p;if(n.settings.mode==="single")return;e=$(e);if(!e.length){$(n.$activeItems).removeClass("active");n.$activeItems=[];if(n.isFocused){n.showInput()}return}i=t&&t.type.toLowerCase();if(i==="mousedown"&&n.isShiftDown&&n.$activeItems.length){p=n.$control.children(".active:last");s=Array.prototype.indexOf.apply(n.$control[0].childNodes,[p[0]]);a=Array.prototype.indexOf.apply(n.$control[0].childNodes,[e[0]]);if(s>a){u=s;s=a;a=u}for(r=s;r<=a;r++){l=n.$control[0].childNodes[r];if(n.$activeItems.indexOf(l)===-1){$(l).addClass("active");n.$activeItems.push(l)}}t.preventDefault()}else if(i==="mousedown"&&n.isCtrlDown||i==="keydown"&&this.isShiftDown){if(e.hasClass("active")){o=n.$activeItems.indexOf(e[0]);n.$activeItems.splice(o,1);e.removeClass("active")}else{n.$activeItems.push(e.addClass("active")[0])}}else{$(n.$activeItems).removeClass("active");n.$activeItems=[e.addClass("active")[0]]}n.hideInput();if(!this.isFocused){n.focus()}},setActiveOption:function(e,t,n){var i,r,o;var s,a;var l=this;if(l.$activeOption)l.$activeOption.removeClass("active");l.$activeOption=null;e=$(e);if(!e.length)return;l.$activeOption=e.addClass("active");if(t||!W(t)){i=l.$dropdownContent.height();r=l.$activeOption.outerHeight(true);t=l.$dropdownContent.scrollTop()||0;o=l.$activeOption.offset().top-l.$dropdownContent.offset().top+t;s=o;a=o-i+r;if(o+r>i+t){l.$dropdownContent.stop().animate({scrollTop:a},n?l.settings.scrollDuration:0)}else if(o<t){l.$dropdownContent.stop().animate({scrollTop:s},n?l.settings.scrollDuration:0)}}},selectAll:function(){var e=this;if(e.settings.mode==="single")return;e.$activeItems=Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active"));if(e.$activeItems.length){e.hideInput();e.close()}e.focus()},hideInput:function(){var e=this;e.setTextboxValue("");e.$controlInput.css({opacity:0,position:"absolute",left:e.rtl?1e4:-1e4});e.isInputHidden=true},showInput:function(){this.$controlInput.css({opacity:1,position:"relative",left:0});this.isInputHidden=false},focus:function(){var e=this;if(e.isDisabled)return;e.ignoreFocus=true;e.$controlInput[0].focus();window.setTimeout(function(){e.ignoreFocus=false;e.onFocus()},0)},blur:function(e){this.$controlInput[0].blur();this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings;var t=e.sortField;if(typeof t==="string"){t=[{field:t}]}return{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(e){var t,n,i;var r=this;var o=r.settings;var s=this.getSearchOptions();if(o.score){i=r.settings.score.apply(this,[e]);if(typeof i!=="function"){throw new Error('Selectize "score" setting must be a function that returns a function')}}if(e!==r.lastQuery){r.lastQuery=e;n=r.sifter.search(e,$.extend(s,{score:i}));r.currentResults=n}else{n=$.extend(true,{},r.currentResults)}if(o.hideSelected){for(t=n.items.length-1;t>=0;t--){if(r.items.indexOf(U(n.items[t].id))!==-1){n.items.splice(t,1)}}}return n},refreshOptions:function(e){var t,n,i,r,o,s,a,l,u,p,c,f,d;var h,g,v;if(typeof e==="undefined"){e=true}var m=this;var y=$.trim(m.$controlInput.val());var w=m.search(y);var O=m.$dropdownContent;var C=m.$activeOption&&U(m.$activeOption.attr("data-value"));r=w.items.length;if(typeof m.settings.maxOptions==="number"){r=Math.min(r,m.settings.maxOptions)}o={};s=[];for(t=0;t<r;t++){a=m.options[w.items[t].id];l=m.render("option",a);u=a[m.settings.optgroupField]||"";p=$.isArray(u)?u:[u];for(n=0,i=p&&p.length;n<i;n++){u=p[n];if(!m.optgroups.hasOwnProperty(u)){u=""}if(!o.hasOwnProperty(u)){o[u]=document.createDocumentFragment();s.push(u)}o[u].appendChild(l)}}if(this.settings.lockOptgroupOrder){s.sort(function(e,t){var n=m.optgroups[e].$order||0;var i=m.optgroups[t].$order||0;return n-i})}c=document.createDocumentFragment();for(t=0,r=s.length;t<r;t++){u=s[t];if(m.optgroups.hasOwnProperty(u)&&o[u].childNodes.length){f=document.createDocumentFragment();f.appendChild(m.render("optgroupHeader",m.optgroups[u]));f.appendChild(o[u]);c.appendChild(m.render("optgroup",$.extend({},m.optgroups[u],{html:oe(f),dom:f})))}else{c.appendChild(o[u])}}O.html(c);if(m.settings.highlight&&w.query.length&&w.tokens.length){O.removeHighlight();for(t=0,r=w.tokens.length;t<r;t++){F(O,w.tokens[t].regex)}}if(!m.settings.hideSelected){for(t=0,r=m.items.length;t<r;t++){m.getOption(m.items[t]).addClass("selected")}}d=m.canCreate(y);if(d){O.prepend(m.render("optionCreate",{input:y}));v=$(O[0].childNodes[0])}m.hasOptions=w.items.length>0||d;if(m.hasOptions){if(w.items.length>0){g=C&&m.getOption(C);if(g&&g.length){h=g}else if(m.settings.mode==="single"&&m.items.length){h=m.getOption(m.items[0])}if(!h||!h.length){if(v&&!m.settings.addPrecedence){h=m.getAdjacentOption(v,1)}else{h=O.find("[data-selectable]:first")}}}else{h=v}m.setActiveOption(h);if(e&&!m.isOpen){m.open()}}else{m.setActiveOption(null);if(e&&m.isOpen){m.close()}}},addOption:function(e){var t,n,i,r=this;if($.isArray(e)){for(t=0,n=e.length;t<n;t++){r.addOption(e[t])}return}if(i=r.registerOption(e)){r.userOptions[i]=true;r.lastQuery=null;r.trigger("optionAdd",i,e)}},registerOption:function(e){var t=U(e[this.settings.valueField]);if(typeof t==="undefined"||t===null||this.options.hasOwnProperty(t))return false;e.$order=e.$order||++this.order;this.options[t]=e;return t},registerOptionGroup:function(e){var t=U(e[this.settings.optgroupValueField]);if(!t)return false;e.$order=e.$order||++this.order;this.optgroups[t]=e;return t},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e;if(e=this.registerOptionGroup(t)){this.trigger("optgroupAdd",e,t)}},removeOptionGroup:function(e){if(this.optgroups.hasOwnProperty(e)){delete this.optgroups[e];this.renderCache={};this.trigger("optgroupRemove",e)}},clearOptionGroups:function(){this.optgroups={};this.renderCache={};this.trigger("optgroupClear")},updateOption:function(e,t){var n=this;var i,r;var o,s,a,l,u;e=U(e);o=U(t[n.settings.valueField]);if(e===null)return;if(!n.options.hasOwnProperty(e))return;if(typeof o!=="string")throw new Error("Value must be set in option data");u=n.options[e].$order;if(o!==e){delete n.options[e];s=n.items.indexOf(e);if(s!==-1){n.items.splice(s,1,o)}}t.$order=t.$order||u;n.options[o]=t;a=n.renderCache.item;l=n.renderCache.option;if(a){delete a[e];delete a[o]}if(l){delete l[e];delete l[o]}if(n.items.indexOf(o)!==-1){i=n.getItem(e);r=$(n.render("item",t))
;if(i.hasClass("active"))r.addClass("active");i.replaceWith(r)}n.lastQuery=null;if(n.isOpen){n.refreshOptions(false)}},removeOption:function(e,t){var n=this;e=U(e);var i=n.renderCache.item;var r=n.renderCache.option;if(i)delete i[e];if(r)delete r[e];delete n.userOptions[e];delete n.options[e];n.lastQuery=null;n.trigger("optionRemove",e);n.removeItem(e,t)},clearOptions:function(){var e=this;e.loadedSearches={};e.userOptions={};e.renderCache={};e.options=e.sifter.items={};e.lastQuery=null;e.trigger("optionClear");e.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdownContent.find("[data-selectable]"))},getAdjacentOption:function(e,t){var n=this.$dropdown.find("[data-selectable]");var i=n.index(e)+t;return i>=0&&i<n.length?n.eq(i):$()},getElementWithValue:function(e,t){e=U(e);if(typeof e!=="undefined"&&e!==null){for(var n=0,i=t.length;n<i;n++){if(t[n].getAttribute("data-value")===e){return $(t[n])}}}return $()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(e,t){var n=$.isArray(e)?e:[e];for(var i=0,r=n.length;i<r;i++){this.isPending=i<r-1;this.addItem(n[i],t)}},addItem:function(e,t){var n=t?[]:["change"];Z(this,n,function(){var n,i,r;var o=this;var s=o.settings.mode;var a,l;e=U(e);if(o.items.indexOf(e)!==-1){if(s==="single")o.close();return}if(!o.options.hasOwnProperty(e))return;if(s==="single")o.clear(t);if(s==="multi"&&o.isFull())return;n=$(o.render("item",o.options[e]));l=o.isFull();o.items.splice(o.caretPos,0,e);o.insertAtCaret(n);if(!o.isPending||!l&&o.isFull()){o.refreshState()}if(o.isSetup){r=o.$dropdownContent.find("[data-selectable]");if(!o.isPending){i=o.getOption(e);a=o.getAdjacentOption(i,1).attr("data-value");o.refreshOptions(o.isFocused&&s!=="single");if(a){o.setActiveOption(o.getOption(a))}}if(!r.length||o.isFull()){o.close()}else{o.positionDropdown()}o.updatePlaceholder();o.trigger("itemAdd",e,n);o.updateOriginalInput({silent:t})}})},removeItem:function(e,t){var n=this;var i,r,o;i=e instanceof $?e:n.getItem(e);e=U(i.attr("data-value"));r=n.items.indexOf(e);if(r!==-1){i.remove();if(i.hasClass("active")){o=n.$activeItems.indexOf(i[0]);n.$activeItems.splice(o,1)}n.items.splice(r,1);n.lastQuery=null;if(!n.settings.persist&&n.userOptions.hasOwnProperty(e)){n.removeOption(e,t)}if(r<n.caretPos){n.setCaret(n.caretPos-1)}n.refreshState();n.updatePlaceholder();n.updateOriginalInput({silent:t});n.positionDropdown();n.trigger("itemRemove",e,i)}},createItem:function(e,t){var n=this;var i=n.caretPos;e=e||$.trim(n.$controlInput.val()||"");var r=arguments[arguments.length-1];if(typeof r!=="function")r=function(){};if(typeof t!=="boolean"){t=true}if(!n.canCreate(e)){r();return false}n.lock();var o=typeof n.settings.create==="function"?this.settings.create:function(e){var t={};t[n.settings.labelField]=e;t[n.settings.valueField]=e;return t};var s=X(function(e){n.unlock();if(!e||typeof e!=="object")return r();var o=U(e[n.settings.valueField]);if(typeof o!=="string")return r();n.setTextboxValue("");n.addOption(e);n.setCaret(i);n.addItem(o);n.refreshOptions(t&&n.settings.mode!=="single");r(e)});var a=o.apply(this,[e,s]);if(typeof a!=="undefined"){s(a)}return true},refreshItems:function(){this.lastQuery=null;if(this.isSetup){this.addItem(this.items)}this.refreshState();this.updateOriginalInput()},refreshState:function(){this.refreshValidityState();this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return false;var e=!this.items.length;this.isInvalid=e;this.$controlInput.prop("required",e);this.$input.prop("required",!e)},refreshClasses:function(){var e=this;var t=e.isFull();var n=e.isLocked;e.$wrapper.toggleClass("rtl",e.rtl);e.$control.toggleClass("focus",e.isFocused).toggleClass("disabled",e.isDisabled).toggleClass("required",e.isRequired).toggleClass("invalid",e.isInvalid).toggleClass("locked",n).toggleClass("full",t).toggleClass("not-full",!t).toggleClass("input-active",e.isFocused&&!e.isInputHidden).toggleClass("dropdown-active",e.isOpen).toggleClass("has-options",!$.isEmptyObject(e.options)).toggleClass("has-items",e.items.length>0);e.$controlInput.data("grow",!t&&!n)},isFull:function(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,n,i,r,o=this;e=e||{};if(o.tagType===G){i=[];for(t=0,n=o.items.length;t<n;t++){r=o.options[o.items[t]][o.settings.labelField]||"";i.push('<option value="'+J(o.items[t])+'" selected="selected">'+J(r)+"</option>")}if(!i.length&&!this.$input.attr("multiple")){i.push('<option value="" selected="selected"></option>')}o.$input.html(i.join(""))}else{o.$input.val(o.getValue());o.$input.attr("value",o.$input.val())}if(o.isSetup){if(!e.silent){o.trigger("change",o.$input.val())}}},updatePlaceholder:function(){if(!this.settings.placeholder)return;var e=this.$controlInput;if(this.items.length){e.removeAttr("placeholder")}else{e.attr("placeholder",this.settings.placeholder)}e.triggerHandler("update",{force:true})},open:function(){var e=this;if(e.isLocked||e.isOpen||e.settings.mode==="multi"&&e.isFull())return;e.focus();e.isOpen=true;e.refreshState();e.$dropdown.css({visibility:"hidden",display:"block"});e.positionDropdown();e.$dropdown.css({visibility:"visible"});e.trigger("dropdownOpen",e.$dropdown)},close:function(){var e=this;var t=e.isOpen;if(e.settings.mode==="single"&&e.items.length){e.hideInput();e.$controlInput.blur()}e.isOpen=false;e.$dropdown.hide();e.setActiveOption(null);e.refreshState();if(t)e.trigger("dropdownClose",e.$dropdown)},positionDropdown:function(){var e=this.$control;var t=this.settings.dropdownParent==="body"?e.offset():e.position();t.top+=e.outerHeight(true);this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(e){var t=this;if(!t.items.length)return;t.$control.children(":not(input)").remove();t.items=[];t.lastQuery=null;t.setCaret(0);t.setActiveItem(null);t.updatePlaceholder();t.updateOriginalInput({silent:e});t.refreshState();t.showInput();t.trigger("clear")},insertAtCaret:function(e){var t=Math.min(this.caretPos,this.items.length);if(t===0){this.$control.prepend(e)}else{$(this.$control[0].childNodes[t]).before(e)}this.setCaret(t+1)},deleteSelection:function(e){var t,n,i,r,o,s,a,l,u;var p=this;i=e&&e.keyCode===L?-1:1;r=te(p.$controlInput[0]);if(p.$activeOption&&!p.settings.hideSelected){a=p.getAdjacentOption(p.$activeOption,-1).attr("data-value")}o=[];if(p.$activeItems.length){u=p.$control.children(".active:"+(i>0?"last":"first"));s=p.$control.children(":not(input)").index(u);if(i>0){s++}for(t=0,n=p.$activeItems.length;t<n;t++){o.push($(p.$activeItems[t]).attr("data-value"))}if(e){e.preventDefault();e.stopPropagation()}}else if((p.isFocused||p.settings.mode==="single")&&p.items.length){if(i<0&&r.start===0&&r.length===0){o.push(p.items[p.caretPos-1])}else if(i>0&&r.start===p.$controlInput.val().length){o.push(p.items[p.caretPos])}}if(!o.length||typeof p.settings.onDelete==="function"&&p.settings.onDelete.apply(p,[o])===false){return false}if(typeof s!=="undefined"){p.setCaret(s)}while(o.length){p.removeItem(o.pop())}p.showInput();p.positionDropdown();p.refreshOptions(true);if(a){l=p.getOption(a);if(l.length){p.setActiveOption(l)}}return true},advanceSelection:function(e,t){var n,i,r,o,s,a;var l=this;if(e===0)return;if(l.rtl)e*=-1;n=e>0?"last":"first";i=te(l.$controlInput[0]);if(l.isFocused&&!l.isInputHidden){o=l.$controlInput.val().length;s=e<0?i.start===0&&i.length===0:i.start===o;if(s&&!o){l.advanceCaret(e,t)}}else{a=l.$control.children(".active:"+n);if(a.length){r=l.$control.children(":not(input)").index(a);l.setActiveItem(null);l.setCaret(e>0?r+1:r)}}},advanceCaret:function(e,t){var n=this,i,r;if(e===0)return;i=e>0?"next":"prev";if(n.isShiftDown){r=n.$controlInput[i]();if(r.length){n.hideInput();n.setActiveItem(r);if(t)t.preventDefault()}}else{n.setCaret(n.caretPos+e)}},setCaret:function(e){var t=this;if(t.settings.mode==="single"){e=t.items.length}else{e=Math.max(0,Math.min(t.items.length,e))}if(!t.isPending){var n,i,r,o;r=t.$control.children(":not(input)");for(n=0,i=r.length;n<i;n++){o=$(r[n]).detach();if(n<e){t.$controlInput.before(o)}else{t.$control.append(o)}}}t.caretPos=e},lock:function(){this.close();this.isLocked=true;this.refreshState()},unlock:function(){this.isLocked=false;this.refreshState()},disable:function(){var e=this;e.$input.prop("disabled",true);e.$controlInput.prop("disabled",true).prop("tabindex",-1);e.isDisabled=true;e.lock()},enable:function(){var e=this;e.$input.prop("disabled",false);e.$controlInput.prop("disabled",false).prop("tabindex",e.tabIndex);e.isDisabled=false;e.unlock()},destroy:function(){var e=this;var t=e.eventNS;var n=e.revertSettings;e.trigger("destroy");e.off();e.$wrapper.remove();e.$dropdown.remove();e.$input.html("").append(n.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:n.tabindex}).show();e.$controlInput.removeData("grow");e.$input.removeData("selectize");$(window).off(t);$(document).off(t);$(document.body).off(t);delete e.$input[0].selectize},render:function(e,t){var n,i;var r="";var o=false;var s=this;if(e==="option"||e==="item"){n=U(t[s.settings.valueField]);o=!!n}if(o){if(!W(s.renderCache[e])){s.renderCache[e]={}}if(s.renderCache[e].hasOwnProperty(n)){return s.renderCache[e][n]}}r=$(s.settings.render[e].apply(this,[t,J]));if(e==="option"||e==="optionCreate"){r.attr("data-selectable","")}else if(e==="optgroup"){i=t[s.settings.optgroupValueField]||"";r.attr("data-group",i)}if(e==="option"||e==="item"){r.attr("data-value",n||"")}if(o){s.renderCache[e][n]=r[0]}return r[0]},clearCache:function(e){var t=this;if(typeof e==="undefined"){t.renderCache={}}else{delete t.renderCache[e]}},canCreate:function(e){var t=this;if(!t.settings.create)return false;var n=t.settings.createFilter;return e.length&&(typeof n!=="function"||n.apply(t,[e]))&&(typeof n!=="string"||new RegExp(n).test(e))&&(!(n instanceof RegExp)||n.test(e))}});function ae(e,t){var n=$.extend({},A,t);var i=n.dataAttr;var r=n.labelField;var o=n.valueField;var s=n.optgroupField;var a=n.optgroupLabelField;var l=n.optgroupValueField;var u=function(e,t){var s,a,l,u;var p=e.attr(i);if(!p){var c=$.trim(e.val()||"");if(!n.allowEmptyOption&&!c.length)return;l=c.split(n.delimiter);for(s=0,a=l.length;s<a;s++){u={};u[r]=l[s];u[o]=l[s];t.options.push(u)}t.items=l}else{t.options=JSON.parse(p);for(s=0,a=t.options.length;s<a;s++){t.items.push(t.options[s][o])}}};var p=function(e,t){var u,p,c,f;var d=t.options;var h={};var g=function(e){var t=i&&e.attr(i);if(typeof t==="string"&&t.length){return JSON.parse(t)}return null};var v=function(e,i){e=$(e);var a=U(e.val());if(!a&&!n.allowEmptyOption)return;if(h.hasOwnProperty(a)){if(i){var l=h[a][s];if(!l){h[a][s]=i}else if(!$.isArray(l)){h[a][s]=[l,i]}else{l.push(i)}}return}var u=g(e)||{};u[r]=u[r]||e.text();u[o]=u[o]||a;u[s]=u[s]||i;h[a]=u;d.push(u);if(e.is(":selected")){t.items.push(a)}};var m=function(e){var n,i,r,o,s;e=$(e);r=e.attr("label");if(r){o=g(e)||{};o[a]=r;o[l]=r;t.optgroups.push(o)}s=$("option",e);for(n=0,i=s.length;n<i;n++){v(s[n],r)}};t.maxItems=e.attr("multiple")?null:1;f=e.children();for(u=0,p=f.length;u<p;u++){c=f[u].tagName.toLowerCase();if(c==="optgroup"){m(f[u])}else if(c==="option"){v(f[u])}}};return e.each(function(){if(this.selectize)return;var e;var i=$(this);var r=this.tagName.toLowerCase();var o=i.attr("placeholder")||i.attr("data-placeholder");if(!o&&!n.allowEmptyOption){o=i.children('option[value=""]').text()}var s={placeholder:o,options:[],optgroups:[],items:[]};if(r==="select"){p(i,s)}else{u(i,s)}e=new se(i,$.extend(true,{},A,s,t))})}return ae}();